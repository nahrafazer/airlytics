<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>AQI Classification</title>
    <link rel="stylesheet" href="output.css" />
    <link rel="stylesheet" href="gauge.css" />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link href="https://fonts.googleapis.com/css2?family=Nunito:ital,wght@0,200..1000;1,200..1000&display=swap"
        rel="stylesheet" />
    <style>
        body {
            font-family: "Nunito", sans-serif;
        }

        #title {
            font-weight: 900;
        }

        #ispubaik {
            font-weight: 700;
            display: none;
        }

        #ispusedang {
            font-weight: 700;
            display: none;
        }

        #isputidaksehat {
            font-weight: 700;
            display: none;
        }

        #ispusangattidaksehat {
            font-weight: 700;
            display: none;
        }

        #ispuberbahaya {
            font-weight: 700;
            display: none;
        }

                .temp-humid-value {
            font-size: 3rem; /* Larger font size */
            font-weight: bold; /* Bold text */
            color: #233a6d; /* A color that contrasts well with the blue gradient */
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.1); /* Subtle text shadow for depth */
            margin-top: 0.5rem; /* Space from the title */
        }

        .temp-humid-label {
            font-size: 1.25rem; /* Smaller font size for label */
            font-weight: 700; /* Bold text */
            color: #233a6d; /* Consistent color */
        }
    </style>
</head>

<body class="bg-darker-grey min-h-screen flex flex-col">
    <!-- START TAMPILAN DESKTOP -->
    <div class="container max-w-full justify-center max-h-screen flex-col px-2 hidden md:flex" id="container-desktop">
        <div class="relative h-72 w-full mt-2 rounded-2xl bg-opacity-20">
            <div class="flex flex-row size-full">
                <div class="h-full w-1/3 rounded-2xl bg-gradient-to-tr from-darker-blue to-lighter-blue flex-col flex justify-center items-center  text-cyan-950"
                    id="classnum">
                    <!-- <p class=" text-2xl inset-x-0 top-0">AIR QUALITY CLASSIFICATION</p> -->
                    <p class=" text-3xl mb-3 font-bold" id="ispu">Kualitas Udara</p>
                    <p class="text-4xl font-extrabold" id="kategori"></p>
                </div>
                <div class="flex flex-col ml-1 gap-1 w-1/3">
                    <div
                        class="h-full bg-gradient-to-tr from-darker-blue to-lighter-blue rounded-2xl flex justify-center items-center p-2 overflow-x-hidden">
                        <p class="text-center" id="ispubaik">Tingkat kualitas udara yang sangat baik, tidak memberikan
                            efek negatif terhadap manusia, hewan, dan tumbuhan. <br> <span
                                class=" font-extrabold mt-2">Rekomendasi:</span> Sangat baik melakukan kegiatan di luar.
                        </p>
                        <p class="text-center" id="ispusedang">Tingkat kualitas udara masih dapat diterima pada
                            kesehatan manusia, hewan, dan tumbuhan. <br> <span
                                class=" font-extrabold">Rekomendasi:</span> <br>Kelompok Sensitif: Kurangi aktivitas
                            fisik yang terlalu lama atau berat. <br>Semua Orang: Masih dapat beraktivitas di luar.</p>
                        <p class="text-center" id="isputidaksehat">Tingkat kualitas udara yang bersifat merugikan pada
                            manusia, hewan, dan tumbuhan. <br> <span class=" font-extrabold">Rekomendasi:</span>
                            <br>Penderita Asma: Harus mengikuti petunjuk kesehatan untuk asma dan menyimpan obat asma.
                            <br>Penderita Penyakit Jantung: Gejala seperti palpitasi/jatntung berdetak lebih cepat,
                            sesak nafas, atau kelelahan yang tidak biasa mungkin mengindikasikan masalah serius.
                            <br>Setiap Orang: Mengurangi aktivitas fisik yang terlalu lama di luar ruangan.
                        </p>
                        <p class="text-center" id="ispusangattidaksehat">Tingkat kualitas udara dapat meningkatkan
                            resiko kesehatan pada sejumlah segmen populasi yang terpapar. <br> <span
                                class=" font-extrabold">Rekomendasi:</span> <br>Kelompok Sensitif: Hindari semua
                            aktivitas di luar. <br>Semua Orang: Hindari semua aktivitas fisik yang terlalu lama di luar
                            ruangan. Pertimbangkan untuk melakukan aktivitas di dalam ruangan.</p>
                        <p class="text-center" id="ispuberbahaya">Tingkat kualitas udara yang dapat merugikan kesehatan
                            serius pada populasi dan perlu penanganan cepat. <br> <span
                                class=" font-extrabold">Rekomendasi:</span> <br>Kelompok Sensitif: Tetap di dalam
                            ruangan dan hanya melakukan sedikit aktivitas. <br>Semua Orang: Hindari semua aktvitas di
                            luar.</p>
                    </div>
                </div>
                <div class="flex flex-col ml-1 gap-1 w-1/3">
                    <div class="h-1/2 bg-gradient-to-tr from-darker-blue to-lighter-blue rounded-2xl flex flex-col justify-center items-center p-2"
                        id="temp">
                        <p class="temp-humid-label mb-1">Temperature</p>
                        <div class="flex items-center w-full justify-center">
                            <img src="thermometer.png" alt="Temperature Icon"
                                class="w-16 h-16 mr-2">
                            <p class="temp-humid-value" id="temperature-value"></p>
                        </div>
                    </div>
                    <div class="h-1/2 bg-gradient-to-tr from-darker-blue to-lighter-blue rounded-2xl flex flex-col justify-center items-center p-2"
                        id="humid">
                        <p class="temp-humid-label mb-1">Humidity</p>
                        <div class="flex items-center w-full justify-center">
                            <img src="humidity.png"
                                alt="Humidity Icon" class="w-12 h-12 mr-2">
                            <p class="temp-humid-value" id="humidity-value"></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="container max-w-full flex justify-center items-start h-auto">
            <!-- PM2.5 -->
            <div
                class="h-52 w-full my-2 bg-lighter-blue rounded-2xl mr-2 p-2 flex flex-col justify-center items-center">
                <p class=" font-bold text-xl">PM2.5</p>
                <div class="pm25gauge">
                    <div class="gauge__body mt-2">
                        <div class="gauge__fill"></div>
                        <div class="gauge__cover bg-lighter-blue"></div>
                    </div>
                </div>
            </div>
            <!-- PM10 -->
            <div class="h-52 w-full my-2 bg-lighter-blue rounded-2xl p-2 flex flex-col justify-center items-center">
                <p class=" font-bold text-xl">PM10</p>
                <div class="pm10gauge">
                    <div class="gauge__body mt-2">
                        <div class="gauge__fill"></div>
                        <div class="gauge__cover bg-lighter-blue"></div>
                    </div>
                </div>
            </div>
            <!-- CO -->
            <div
                class="h-52 w-full my-2 bg-lighter-blue rounded-2xl mx-2 p-2 flex flex-col justify-center items-center">
                <p class=" font-bold text-xl">Karbon Monoksida</p>
                <div class="cogauge">
                    <div class="gauge__body mt-2">
                        <div class="gauge__fill"></div>
                        <div class="gauge__cover bg-lighter-blue"></div>
                    </div>
                </div>
            </div>
            <!-- NO₂ -->
            <div class="h-52 w-full my-2 bg-lighter-blue rounded-2xl p-2 flex flex-col justify-center items-center">
                <p class=" font-bold text-xl">Nitrogen Dioksida</p>
                <div class="no2gauge">
                    <div class="gauge__body mt-2">
                        <div class="gauge__fill"></div>
                        <div class="gauge__cover bg-lighter-blue"></div>
                    </div>
                </div>
            </div>
            <!-- O₃ -->
            <div
                class="h-52 w-full my-2 bg-lighter-blue rounded-2xl ml-2 p-2 flex flex-col justify-center items-center">
                <p class=" font-bold text-xl">Ozon</p>
                <div class="o3gauge">
                    <div class="gauge__body mt-2">
                        <div class="gauge__fill"></div>
                        <div class="gauge__cover bg-lighter-blue"></div>
                    </div>
                </div>
            </div>
        </div>
        <div
            class="h-52 w-full bg-gradient-to-t from-darker-blue to-lighter-blue rounded-2xl p-1 flex justify-between gap-1">
            <div class=" w-fit rounded-2xl flex flex-col justify-center items-center gap-1">
                <button
                    class="w-full h-full rounded-xl bg-blue-500 text-[#233a6d] shadow-md p-1 ease-in duration-100 hover:bg-blue-400 hover:text-[#344c73] font-extrabold"><a
                        href="graph.html">HISTORY DATA</a></button>
                <button
                    class="w-full h-full rounded-xl bg-blue-500 text-[#233a6d] shadow-md p-1 ease-in duration-100 hover:bg-blue-400 hover:text-[#344c73] font-extrabold"><a
                        href="download_center.html">DOWNLOAD DATA</a></button>
            </div>
            <div class="w-full bg-hijaubaik rounded-2xl flex flex-col justify-center items-center">
                <p class="text-4xl text-hijaubaikteks font-extrabold">0-50</p>
                <p class="text-xl text-hijaubaikteks font-bold">BAIK</p>
            </div>
            <div class="w-full bg-kuningsedang rounded-2xl flex flex-col justify-center items-center">
                <p class="text-4xl text-kuningsedangteks font-extrabold">51-100</p>
                <p class="text-xl text-kuningsedangteks font-bold">SEDANG</p>
            </div>
            <div class="w-full bg-orangetidaksehat rounded-2xl flex flex-col justify-center items-center">
                <p class="text-4xl text-orangetidaksehatteks font-extrabold">101-200</p>
                <p class="text-xl text-orangetidaksehatteks font-bold">TIDAK SEHAT</p>
            </div>
            <div class="w-full bg-merahsangattidaksehat rounded-2xl flex flex-col justify-center items-center">
                <p class="text-4xl text-merahsangattidaksehatteks font-extrabold">201-300</p>
                <p class="text-xl text-merahsangattidaksehatteks font-bold">SANGAT TIDAK SEHAT</p>
            </div>
            <div class="w-full bg-unguberbahaya rounded-2xl flex flex-col justify-center items-center">
                <p class="text-4xl text-unguberbahayateks font-extrabold">300+</p>
                <p class="text-xl text-unguberbahayateks font-bold">BERBAHAYA</p>
            </div>
        </div>
    </div>
    <!-- END TAMPILAN DESKTOP -->
    <!-- ------------------------------------------------------------------------------------------------------------------------------------------------- -->
    <!-- START TAMPILAN MOBILE -->
    <!-- <div class="container max-w-full flex flex-col px-2 md:hidden" id="container-mobile">
        <div class="relative w-full mt-2 rounded-2xl bg-opacity-20">
            <div class="flex flex-col gap-2">
                <div class="w-full rounded-2xl bg-gradient-to-tr from-darker-blue to-lighter-blue flex justify-center items-center text-xl text-cyan-950 py-4 font-extrabold"
                    id="title-mobile">
                    AIR QUALITY CLASSIFICATION
                </div>
                <div class="w-full rounded-2xl bg-gradient-to-tr from-darker-blue to-lighter-blue flex justify-center items-center text-6xl font-bold text-cyan-950 py-6"
                    id="classnum-mobile">
                    85
                </div>
                <div
                    class="w-full bg-gradient-to-tr from-darker-blue to-lighter-blue rounded-2xl flex flex-col justify-center items-center px-2 py-3">
                    <p class="text-center text-base font-bold" id="aqibaik-mobile">
                        beraktivitas normal di luar ruangan, namun jika memiliki masalah pernapasan (seperti asma),
                        lebih baik menghindari aktivitas fisik yang berat di luar. menjaga kebersihan udara dalam rumah
                        dengan membuka ventilasi atau menggunakan pembersih udara.
                    </p>
                </div>
            </div>
        </div>
        <div class="grid grid-cols-2 gap-2 my-2">
            <div class="h-40 bg-lighter-blue rounded-2xl p-2 flex flex-col justify-center items-center">
                Temperature
                <div class="tempgauge">
                    <div class="gauge__body mt-2">
                        <div class="gauge__fill"></div>
                        <div class="gauge__cover bg-lighter-blue"></div>
                    </div>
                </div>
            </div>
            <div
                class="h-40 bg-gradient-to-br from-darker-blue to-lighter-blue rounded-2xl p-2 flex flex-col justify-center items-center">
                PM10</div>
            <div
                class="h-40 bg-gradient-to-tl from-darker-blue to-lighter-blue rounded-2xl p-2 flex flex-col justify-center items-center">
                CO</div>
            <div
                class="h-40 bg-gradient-to-bl from-darker-blue to-lighter-blue rounded-2xl p-2 flex flex-col justify-center items-center">
                O3</div>
        </div>

        <div class="h-40 bg-gradient-to-t from-darker-blue to-lighter-blue rounded-2xl p-1 mb-2"></div>
    </div> -->
    <footer
        class="w-full bg-gradient-to-tr from-darker-blue to-lighter-blue px-4 py-2 text-center text-sm text-cyan-950 font-semibold md:hidden">
        &copy; Shahriza Farhan Widodo - 2025
    </footer>
    <!-- END TAMPILAN MOBILE -->
    <!-- ------------------------------------------------------------------------------------------------------------------------------------------------- -->
    <!-- SCRIPT START -->
    <script>
        const gaugeElementpm25 = document.querySelector(".pm25gauge");
        const gaugeElementpm10 = document.querySelector(".pm10gauge");
        const gaugeElementco = document.querySelector(".cogauge");
        const gaugeElementno2 = document.querySelector(".no2gauge");
        const gaugeElemento3 = document.querySelector(".o3gauge");

        function getAirQualityColor(value, pollutant) {
            const thresholds = {
                pm25: [50, 150, 350, 420, 500],
                pm10: [15.5, 55.4, 150.4, 250.4, 500],
                co: [4000, 8000, 15000, 30000, 45000],
                no2: [80, 200, 1130, 2260, 3000],
                o3: [120, 235, 400, 800, 1000]
            };

            const colors = ["#2ecc71", "#f1c40f", "#e67e22", "#e74c3c", "#8e44ad"];
            const t = thresholds[pollutant];

            if (value <= t[0]) return colors[0];
            if (value <= t[1]) return colors[1];
            if (value <= t[2]) return colors[2];
            if (value <= t[3]) return colors[3];
            return colors[4];
        }

        function setGaugeValue(gauge, value, unit, min, max, pollutantKey) {
            let normalized = ((value - min) / (max - min)) * 100;
            if (normalized < 0) normalized = 0;
            if (normalized > 100) normalized = 100;

            const color = getAirQualityColor(value, pollutantKey);
            const fill = gauge.querySelector(".gauge__fill");
            fill.style.transform = `rotate(${normalized / 200}turn)`;
            fill.style.background = color;

            gauge.querySelector(".gauge__cover").innerHTML = `${Math.round(value)} <span style="font-size: 0.6em;">${unit}</span>`;
        }

        const ispuElement = document.getElementById('ispu');
        const kategoriElement = document.getElementById('kategori');

        const ispubaik = document.getElementById('ispubaik');
        const ispusedang = document.getElementById('ispusedang');
        const isputidaksehat = document.getElementById('isputidaksehat');
        const ispusangattidaksehat = document.getElementById('ispusangattidaksehat');
        const ispuberbahaya = document.getElementById('ispuberbahaya');

        function updateKategori(kategori) {
            ispubaik.style.display = 'none';
            ispusedang.style.display = 'none';
            isputidaksehat.style.display = 'none';
            ispusangattidaksehat.style.display = 'none';
            ispuberbahaya.style.display = 'none';

            kategori = kategori.toLowerCase();

            if (kategori.includes("baik")) {
                ispubaik.style.display = 'block';
            } else if (kategori.includes("sedang")) {
                ispusedang.style.display = 'block';
            } else if (kategori.includes("tidak sehat") && !kategori.includes("sangat")) {
                isputidaksehat.style.display = 'block';
            } else if (kategori.includes("sangat tidak sehat")) {
                ispusangattidaksehat.style.display = 'block';
            } else if (kategori.includes("berbahaya")) {
                ispuberbahaya.style.display = 'block';
            }
        }


        function fetchData() {
            fetch("get_sensor_data.php")
                .then(response => response.json())
                .then(data => {
                    if (data.error) {
                        console.error("Gagal ambil data:", data.error);
                        return;
                    }

                    setGaugeValue(gaugeElementpm25, data.PM25_ugm3, 'µg/m³', 0, 500, 'pm25');
                    setGaugeValue(gaugeElementpm10, data.PM10_ugm3, 'µg/m³', 0, 500, 'pm10');
                    setGaugeValue(gaugeElementco, data.CO_ugm3, 'µg/m³', 0, 45000, 'co');
                    setGaugeValue(gaugeElementno2, data.NO2_ugm3, 'µg/m³', 0, 3000, 'no2');
                    setGaugeValue(gaugeElemento3, data.O3_ugm3, 'µg/m³', 0, 1000, 'o3');

                    document.getElementById('temperature-value').innerText = `${Math.round(data.temperature)} °C`;
                    document.getElementById('humidity-value').innerText = `${Math.round(data.humidity)} %RH`;

                    let kategori = data.hasil_prediksi;

                    if (kategori === "Baik") {
                        kategoriElement.innerText = "Baik";
                        kategori = "Baik";
                    } else if (kategori === "Sedang") {
                        kategoriElement.innerText = "Sedang";
                        kategori = "Sedang";
                    } else if (kategori === "Tidak_Sehat") {
                        kategoriElement.innerText = "Tidak Sehat";
                        kategori = "Tidak Sehat";
                    } else if (kategori === "Sangat_Tidak_Sehat") {
                        kategoriElement.innerText = "Sangat Tidak Sehat";
                        kategori = "Sangat Tidak Sehat";
                    } else if (kategori === "Berbahaya") {
                        kategoriElement.innerText = "Berbahaya";
                        kategori = "Berbahaya";
                    }

                    // tampilkan deskripsi
                    updateKategori(kategori);
                })
                .catch(error => console.error('Fetch error:', error));
        }

        fetchData();
        setInterval(fetchData, 5000); // Update setiap 5 detik
    </script>
    <!-- SCRIPT END -->
</body>

</html>